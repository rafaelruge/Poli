import{a as Q}from"./chunk-ZFGCV4GS.js";import{b as j,c as L,d as G,f as U,g as V,h as J,i as B,j as $,k as q,l as z,n as K}from"./chunk-AHCHQWXB.js";import{a as p}from"./chunk-XC3RBIPI.js";import{$ as k,A as u,C as d,E as i,F as e,G as N,J as D,K as h,L as _,M as F,N as n,O as f,P as g,U as R,aa as S,ba as w,da as A,fa as T,ga as H,ia as E,j as C,n as I,o as y,t as c,v as s,w as m,x as b}from"./chunk-EBSKGQ7D.js";var v=class r{constructor(o){this.authService=o}user;ngOnInit(){this.user=this.authService.getUser()}static \u0275fac=function(t){return new(t||r)(s(p))};static \u0275cmp=m({type:r,selectors:[["app-dashboard"]],standalone:!1,decls:13,vars:0,consts:[[1,"ciudadano-dashboard"],[1,"sidebar"],["routerLink","solicitar","routerLinkActive","active"],["routerLink","historial","routerLinkActive","active"],["routerLink","puntos","routerLinkActive","active"],[1,"contenido"]],template:function(t,a){t&1&&(i(0,"div",0)(1,"aside",1)(2,"h2"),n(3,"Panel del Ciudadano"),e(),i(4,"nav")(5,"a",2),n(6,"\u{1F4EC} Solicitar Recolecci\xF3n"),e(),i(7,"a",3),n(8,"\u{1F4DC} Historial de Solicitudes"),e(),i(9,"a",4),n(10,"\u{1F4CD} Puntos Ecol\xF3gicos"),e()()(),i(11,"main",5),N(12,"router-outlet"),e()())},dependencies:[A,T,H],styles:[".ciudadano-dashboard[_ngcontent-%COMP%]{display:flex;min-height:80vh}.ciudadano-dashboard[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]{width:200px;background-color:#275d2b;color:#fff;padding:1rem}.ciudadano-dashboard[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;color:#fff;margin:.5rem 0;text-decoration:none;font-weight:500}.ciudadano-dashboard[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%], .ciudadano-dashboard[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.ciudadano-dashboard[_ngcontent-%COMP%]   .contenido[_ngcontent-%COMP%]{flex:1;padding:2rem;background:#f9f9f9}"]})};function te(r,o){r&1&&(i(0,"div",11),n(1," Debes seleccionar un tipo de residuo. "),e())}var O=class r{constructor(o,t){this.fb=o;this.authService=t;this.form=this.fb.group({tipo:["",j.required]})}form;userNombre="";ngOnInit(){let o=this.authService.getUser();this.userNombre=o?.nombre||""}onSubmit(){let o=this.authService.getUser();if(this.form.valid&&o){let t={id:Date.now(),nombre:o.nombre,email:o.email,fecha:new Date().toISOString().split("T")[0],tipo:this.form.value.tipo,estado:"pendiente"},a=JSON.parse(localStorage.getItem("solicitudes")||"[]");a.push(t),localStorage.setItem("solicitudes",JSON.stringify(a)),alert("Solicitud enviada con \xE9xito"),this.form.reset()}}static \u0275fac=function(t){return new(t||r)(s(z),s(p))};static \u0275cmp=m({type:r,selectors:[["app-solicitar-recoleccion"]],standalone:!1,decls:23,vars:4,consts:[[1,"solicitud-container"],[3,"ngSubmit","formGroup"],[1,"form-field"],["for","tipo"],["id","tipo","formControlName","tipo"],["value",""],["value","Residuos org\xE1nicos"],["value","Comida vencida"],["value","Restos de jardiner\xEDa"],["class","error",4,"ngIf"],["type","submit",3,"disabled"],[1,"error"]],template:function(t,a){if(t&1&&(i(0,"div",0)(1,"h2"),n(2,"Solicitar Recolecci\xF3n de Residuos"),e(),i(3,"p")(4,"strong"),n(5,"Usuario:"),e(),n(6),e(),i(7,"form",1),h("ngSubmit",function(){return a.onSubmit()}),i(8,"div",2)(9,"label",3),n(10,"Tipo de residuo:"),e(),i(11,"select",4)(12,"option",5),n(13,"-- Selecciona una opci\xF3n --"),e(),i(14,"option",6),n(15,"Residuos org\xE1nicos"),e(),i(16,"option",7),n(17,"Comida vencida"),e(),i(18,"option",8),n(19,"Restos de jardiner\xEDa"),e()(),u(20,te,2,0,"div",9),e(),i(21,"button",10),n(22,"Enviar Solicitud"),e()()()),t&2){let l;c(6),g(" ",a.userNombre,""),c(),d("formGroup",a.form),c(13),d("ngIf",((l=a.form.get("tipo"))==null?null:l.invalid)&&((l=a.form.get("tipo"))==null?null:l.touched)),c(),d("disabled",a.form.invalid)}},dependencies:[S,U,$,q,B,L,G,V,J],styles:[".solicitud-container[_ngcontent-%COMP%]{max-width:600px;margin:auto;padding:2rem;background-color:#fff;border-radius:12px;box-shadow:0 4px 8px #0000001a}.solicitud-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:1.5rem;color:#275d2b}.solicitud-container[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]{margin-bottom:1.5rem}.solicitud-container[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-weight:700;margin-bottom:.5rem}.solicitud-container[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .solicitud-container[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:.5rem;border:1px solid #ccc;border-radius:6px}.solicitud-container[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{color:red;font-size:.9rem;margin-top:.3rem}.solicitud-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;padding:.75rem;background-color:#3ba935;color:#fff;border:none;border-radius:6px;font-weight:700;cursor:pointer}.solicitud-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background-color:#9e9e9e}"]})};function ie(r,o){if(r&1){let t=D();i(0,"button",4),h("click",function(){I(t);let l=_().$implicit,Z=_(2);return y(Z.cancelarSolicitud(l.id))}),n(1," Cancelar "),e()}}function ne(r,o){if(r&1&&(i(0,"tr")(1,"td"),n(2),e(),i(3,"td"),n(4),e(),i(5,"td"),n(6),e(),i(7,"td"),n(8),e(),i(9,"td"),u(10,ie,2,0,"button",3),e()()),r&2){let t=o.$implicit,a=o.index;c(2),f(a+1),c(2),f(t.fecha),c(2),f(t.tipo),c(2),f(t.estado),c(2),d("ngIf",t.estado==="pendiente")}}function oe(r,o){if(r&1&&(i(0,"table")(1,"thead")(2,"tr")(3,"th"),n(4,"#"),e(),i(5,"th"),n(6,"Fecha"),e(),i(7,"th"),n(8,"Tipo"),e(),i(9,"th"),n(10,"Estado"),e(),i(11,"th"),n(12,"Acci\xF3n"),e()()(),i(13,"tbody"),u(14,ne,11,5,"tr",2),e()()),r&2){let t=_();c(14),d("ngForOf",t.solicitudes)}}function re(r,o){r&1&&(i(0,"p"),n(1,"No has registrado solicitudes a\xFAn."),e())}var M=class r{constructor(o){this.authService=o}solicitudes=[];userEmail="";userNombre="";ngOnInit(){let o=this.authService.getUser();this.userEmail=o?.email||"",this.userNombre=o?.nombre||"",this.cargarSolicitudes()}cargarSolicitudes(){let o=JSON.parse(localStorage.getItem("solicitudes")||"[]");this.solicitudes=o.filter(t=>t.email===this.userEmail)}cancelarSolicitud(o){let t=JSON.parse(localStorage.getItem("solicitudes")||"[]"),a=t.findIndex(l=>l.id===o);a!==-1&&t[a].estado==="pendiente"&&(t[a].estado="cancelada",localStorage.setItem("solicitudes",JSON.stringify(t)),this.cargarSolicitudes())}static \u0275fac=function(t){return new(t||r)(s(p))};static \u0275cmp=m({type:r,selectors:[["app-historial"]],standalone:!1,decls:13,vars:4,consts:[["sinSolicitudes",""],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[3,"click",4,"ngIf"],[3,"click"]],template:function(t,a){if(t&1&&(i(0,"h2"),n(1,"Historial de Solicitudes"),e(),i(2,"p")(3,"strong"),n(4,"Usuario:"),e(),n(5),e(),i(6,"p")(7,"strong"),n(8,"Correo:"),e(),n(9),e(),u(10,oe,15,1,"table",1)(11,re,2,0,"ng-template",null,0,R)),t&2){let l=F(12);c(5),g(" ",a.userNombre,""),c(4),g(" ",a.userEmail,""),c(),d("ngIf",a.solicitudes.length>0)("ngIfElse",l)}},dependencies:[k,S],styles:["table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:1rem}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem;border:1px solid #ccc;text-align:left}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#275d2b;color:#fff}table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.3rem .7rem;border:none;background-color:#d9534f;color:#fff;border-radius:4px;cursor:pointer}table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#c9302c}"]})};var ae=[{path:"",component:v,canActivate:[Q],data:{rol:"ciudadano"},children:[{path:"",redirectTo:"solicitar",pathMatch:"full"},{path:"solicitar",component:O},{path:"historial",component:M}]}],P=class r{static \u0275fac=function(t){return new(t||r)};static \u0275mod=b({type:r});static \u0275inj=C({imports:[E.forChild(ae),E]})};var Y=class r{static \u0275fac=function(t){return new(t||r)};static \u0275mod=b({type:r});static \u0275inj=C({imports:[w,P,K]})};export{Y as CiudadanoModule};
